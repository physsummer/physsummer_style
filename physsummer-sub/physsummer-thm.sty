\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{physsummer-thm}

\RequirePackage{xifthen}
\RequirePackage{tcolorbox}
\RequirePackage{etoolbox}
\tcbuselibrary{skins, many, theorems}


\newcommand{\testemptinessthm}[1]{%
    \ifthenelse{\isempty{#1}}{%
        \kern-5pt%
    }{%
        [{#1}]%
    }%
}

\tcbset{
    theo/.style = {
        enhanced,
        colframe = #1!80!black,
        colback = #1!2,
        arc = 0pt,
        attach boxed title to top left = {
            yshift = -2mm,
            xshift = 1cm
        },
        colbacktitle = #1!20,
        coltitle = black,
        fonttitle = \bfseries,
        boxed title style = {arc = 0pt}
    },
    numtheo/.style n args = {3}{
        theo = {#1},
        title = {#2 \thetcbcounter\ \testemptinessthm{#3}},
        before upper = {\protected@edef\@currentlabel{\csname p@theorem\endcsname\csname thetcbcounter\endcsname}}
    },
    startheo/.style n args = {3}{
        theo = {#1},
        title = {#2 \testemptinessthm{#3}}
    }
}


\newtheorem{theorem}{Теорема}[section]
\newtheorem{theorem*}{Теорема}[section]
\newtheorem{definition}{Определение}[section]
\newtheorem{definition*}{Определение}[section]
\newtheorem{conjecture}{Гипотеза}[section]
\newtheorem{lemma}{Лемма}[section]
\newtheorem{lemma*}{Лемма}[section]
\newtheorem{corollary}{Следствие}[section]
\newtheorem{proposition}{Утверждение}[section]
\newtheorem{exercise}{Упражнение}[section]
\newtheorem{example}{Пример}[section]
\newtheorem{remark}{Замечание}[section]
\newtheorem{remark_lect}{Замечание (для преподавателя)}[theorem]


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{theorem}[1][]{
    numtheo = {blue}{Теорема}{#1}
}
\makeatother

\makeatletter
\renewtcolorbox{theorem*}[1][]{
    startheo = {blue}{Теорема}{#1}
}
\makeatother

\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{definition}[1][]{
    numtheo = {blue}{Определение}{#1}
}
\makeatother

\makeatletter
\renewtcolorbox{definition*}[1][]{
    startheo = {blue}{Определение}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{conjecture}[1][]{
    numtheo = {blue}{Гипотеза}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{lemma}[1][]{
    numtheo = {blue}{Лемма}{#1}
}
\makeatother

\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{lemma*}[1][]{
    startheo = {blue}{Лемма}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{corollary}[1][]{
    numtheo = {blue}{Следствие}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{proposition}[1][]{
    numtheo = {blue}{Утверждение}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{exercise}[1][]{
    numtheo = {blue}{Упражнение}{#1}
}
\makeatother

\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{example}[1][]{
    numtheo = {blue}{Пример}{#1}
}
\makeatother


\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{remark}[1][]{
    numtheo = {blue}{Замечание}{#1}
}
\makeatother



\makeatletter
\renewtcolorbox[use counter = theorem, number within = section]{remark_lect}[1][]{
    numtheo = {blue}{Замечание (для преподавателя)}{#1}
}
\makeatother


\newenvironment{proof}{
    \textbf{Доказательство.}
}{
    \hfill
    $\square$
    \vspace{0.01cm}
}
    
\endinput